{"ast":null,"code":"var _ManagedOverlayWidget;\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { findLast } from '../../../../base/common/arraysFind.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { autorun, autorunHandleChanges, autorunOpts, autorunWithStore, observableValue, transaction } from '../../../../base/common/observable.js';\nimport { ElementSizeObserver } from '../../config/elementSizeObserver.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { TextLength } from '../../../common/core/textLength.js';\nexport function joinCombine(arr1, arr2, keySelector, combine) {\n  if (arr1.length === 0) {\n    return arr2;\n  }\n  if (arr2.length === 0) {\n    return arr1;\n  }\n  const result = [];\n  let i = 0;\n  let j = 0;\n  while (i < arr1.length && j < arr2.length) {\n    const val1 = arr1[i];\n    const val2 = arr2[j];\n    const key1 = keySelector(val1);\n    const key2 = keySelector(val2);\n    if (key1 < key2) {\n      result.push(val1);\n      i++;\n    } else if (key1 > key2) {\n      result.push(val2);\n      j++;\n    } else {\n      result.push(combine(val1, val2));\n      i++;\n      j++;\n    }\n  }\n  while (i < arr1.length) {\n    result.push(arr1[i]);\n    i++;\n  }\n  while (j < arr2.length) {\n    result.push(arr2[j]);\n    j++;\n  }\n  return result;\n}\n// TODO make utility\nexport function applyObservableDecorations(editor, decorations) {\n  const d = new DisposableStore();\n  const decorationsCollection = editor.createDecorationsCollection();\n  d.add(autorunOpts({\n    debugName: () => `Apply decorations from ${decorations.debugName}`\n  }, reader => {\n    const d = decorations.read(reader);\n    decorationsCollection.set(d);\n  }));\n  d.add({\n    dispose: () => {\n      decorationsCollection.clear();\n    }\n  });\n  return d;\n}\nexport function appendRemoveOnDispose(parent, child) {\n  parent.appendChild(child);\n  return toDisposable(() => {\n    child.remove();\n  });\n}\nexport function prependRemoveOnDispose(parent, child) {\n  parent.prepend(child);\n  return toDisposable(() => {\n    child.remove();\n  });\n}\nexport class ObservableElementSizeObserver extends Disposable {\n  get width() {\n    return this._width;\n  }\n  get height() {\n    return this._height;\n  }\n  get automaticLayout() {\n    return this._automaticLayout;\n  }\n  constructor(element, dimension) {\n    super();\n    this._automaticLayout = false;\n    this.elementSizeObserver = this._register(new ElementSizeObserver(element, dimension));\n    this._width = observableValue(this, this.elementSizeObserver.getWidth());\n    this._height = observableValue(this, this.elementSizeObserver.getHeight());\n    this._register(this.elementSizeObserver.onDidChange(e => transaction(tx => {\n      /** @description Set width/height from elementSizeObserver */\n      this._width.set(this.elementSizeObserver.getWidth(), tx);\n      this._height.set(this.elementSizeObserver.getHeight(), tx);\n    })));\n  }\n  observe(dimension) {\n    this.elementSizeObserver.observe(dimension);\n  }\n  setAutomaticLayout(automaticLayout) {\n    this._automaticLayout = automaticLayout;\n    if (automaticLayout) {\n      this.elementSizeObserver.startObserving();\n    } else {\n      this.elementSizeObserver.stopObserving();\n    }\n  }\n}\nexport function animatedObservable(targetWindow, base, store) {\n  let targetVal = base.get();\n  let startVal = targetVal;\n  let curVal = targetVal;\n  const result = observableValue('animatedValue', targetVal);\n  let animationStartMs = -1;\n  const durationMs = 300;\n  let animationFrame = undefined;\n  store.add(autorunHandleChanges({\n    createEmptyChangeSummary: () => ({\n      animate: false\n    }),\n    handleChange: (ctx, s) => {\n      if (ctx.didChange(base)) {\n        s.animate = s.animate || ctx.change;\n      }\n      return true;\n    }\n  }, (reader, s) => {\n    /** @description update value */\n    if (animationFrame !== undefined) {\n      targetWindow.cancelAnimationFrame(animationFrame);\n      animationFrame = undefined;\n    }\n    startVal = curVal;\n    targetVal = base.read(reader);\n    animationStartMs = Date.now() - (s.animate ? 0 : durationMs);\n    update();\n  }));\n  function update() {\n    const passedMs = Date.now() - animationStartMs;\n    curVal = Math.floor(easeOutExpo(passedMs, startVal, targetVal - startVal, durationMs));\n    if (passedMs < durationMs) {\n      animationFrame = targetWindow.requestAnimationFrame(update);\n    } else {\n      curVal = targetVal;\n    }\n    result.set(curVal, undefined);\n  }\n  return result;\n}\nfunction easeOutExpo(t, b, c, d) {\n  return t === d ? b + c : c * (-Math.pow(2, -10 * t / d) + 1) + b;\n}\nexport class ViewZoneOverlayWidget extends Disposable {\n  constructor(editor, viewZone, htmlElement) {\n    super();\n    this._register(new ManagedOverlayWidget(editor, htmlElement));\n    this._register(applyStyle(htmlElement, {\n      height: viewZone.actualHeight,\n      top: viewZone.actualTop\n    }));\n  }\n}\nexport class PlaceholderViewZone {\n  get afterLineNumber() {\n    return this._afterLineNumber.get();\n  }\n  constructor(_afterLineNumber, heightInPx) {\n    this._afterLineNumber = _afterLineNumber;\n    this.heightInPx = heightInPx;\n    this.domNode = document.createElement('div');\n    this._actualTop = observableValue(this, undefined);\n    this._actualHeight = observableValue(this, undefined);\n    this.actualTop = this._actualTop;\n    this.actualHeight = this._actualHeight;\n    this.showInHiddenAreas = true;\n    this.onChange = this._afterLineNumber;\n    this.onDomNodeTop = top => {\n      this._actualTop.set(top, undefined);\n    };\n    this.onComputedHeight = height => {\n      this._actualHeight.set(height, undefined);\n    };\n  }\n}\nexport class ManagedOverlayWidget {\n  constructor(_editor, _domElement) {\n    this._editor = _editor;\n    this._domElement = _domElement;\n    this._overlayWidgetId = `managedOverlayWidget-${ManagedOverlayWidget._counter++}`;\n    this._overlayWidget = {\n      getId: () => this._overlayWidgetId,\n      getDomNode: () => this._domElement,\n      getPosition: () => null\n    };\n    this._editor.addOverlayWidget(this._overlayWidget);\n  }\n  dispose() {\n    this._editor.removeOverlayWidget(this._overlayWidget);\n  }\n}\n_ManagedOverlayWidget = ManagedOverlayWidget;\n_ManagedOverlayWidget._counter = 0;\nexport function applyStyle(domNode, style) {\n  return autorun(reader => {\n    /** @description applyStyle */\n    for (let [key, val] of Object.entries(style)) {\n      if (val && typeof val === 'object' && 'read' in val) {\n        val = val.read(reader);\n      }\n      if (typeof val === 'number') {\n        val = `${val}px`;\n      }\n      key = key.replace(/[A-Z]/g, m => '-' + m.toLowerCase());\n      domNode.style[key] = val;\n    }\n  });\n}\nexport function applyViewZones(editor, viewZones, setIsUpdating, zoneIds) {\n  const store = new DisposableStore();\n  const lastViewZoneIds = [];\n  store.add(autorunWithStore((reader, store) => {\n    /** @description applyViewZones */\n    const curViewZones = viewZones.read(reader);\n    const viewZonIdsPerViewZone = new Map();\n    const viewZoneIdPerOnChangeObservable = new Map();\n    // Add/remove view zones\n    if (setIsUpdating) {\n      setIsUpdating(true);\n    }\n    editor.changeViewZones(a => {\n      for (const id of lastViewZoneIds) {\n        a.removeZone(id);\n        zoneIds?.delete(id);\n      }\n      lastViewZoneIds.length = 0;\n      for (const z of curViewZones) {\n        const id = a.addZone(z);\n        if (z.setZoneId) {\n          z.setZoneId(id);\n        }\n        lastViewZoneIds.push(id);\n        zoneIds?.add(id);\n        viewZonIdsPerViewZone.set(z, id);\n      }\n    });\n    if (setIsUpdating) {\n      setIsUpdating(false);\n    }\n    // Layout zone on change\n    store.add(autorunHandleChanges({\n      createEmptyChangeSummary() {\n        return {\n          zoneIds: []\n        };\n      },\n      handleChange(context, changeSummary) {\n        const id = viewZoneIdPerOnChangeObservable.get(context.changedObservable);\n        if (id !== undefined) {\n          changeSummary.zoneIds.push(id);\n        }\n        return true;\n      }\n    }, (reader, changeSummary) => {\n      /** @description layoutZone on change */\n      for (const vz of curViewZones) {\n        if (vz.onChange) {\n          viewZoneIdPerOnChangeObservable.set(vz.onChange, viewZonIdsPerViewZone.get(vz));\n          vz.onChange.read(reader);\n        }\n      }\n      if (setIsUpdating) {\n        setIsUpdating(true);\n      }\n      editor.changeViewZones(a => {\n        for (const id of changeSummary.zoneIds) {\n          a.layoutZone(id);\n        }\n      });\n      if (setIsUpdating) {\n        setIsUpdating(false);\n      }\n    }));\n  }));\n  store.add({\n    dispose() {\n      if (setIsUpdating) {\n        setIsUpdating(true);\n      }\n      editor.changeViewZones(a => {\n        for (const id of lastViewZoneIds) {\n          a.removeZone(id);\n        }\n      });\n      zoneIds?.clear();\n      if (setIsUpdating) {\n        setIsUpdating(false);\n      }\n    }\n  });\n  return store;\n}\nexport class DisposableCancellationTokenSource extends CancellationTokenSource {\n  dispose() {\n    super.dispose(true);\n  }\n}\nexport function translatePosition(posInOriginal, mappings) {\n  const mapping = findLast(mappings, m => m.original.startLineNumber <= posInOriginal.lineNumber);\n  if (!mapping) {\n    // No changes before the position\n    return Range.fromPositions(posInOriginal);\n  }\n  if (mapping.original.endLineNumberExclusive <= posInOriginal.lineNumber) {\n    const newLineNumber = posInOriginal.lineNumber - mapping.original.endLineNumberExclusive + mapping.modified.endLineNumberExclusive;\n    return Range.fromPositions(new Position(newLineNumber, posInOriginal.column));\n  }\n  if (!mapping.innerChanges) {\n    // Only for legacy algorithm\n    return Range.fromPositions(new Position(mapping.modified.startLineNumber, 1));\n  }\n  const innerMapping = findLast(mapping.innerChanges, m => m.originalRange.getStartPosition().isBeforeOrEqual(posInOriginal));\n  if (!innerMapping) {\n    const newLineNumber = posInOriginal.lineNumber - mapping.original.startLineNumber + mapping.modified.startLineNumber;\n    return Range.fromPositions(new Position(newLineNumber, posInOriginal.column));\n  }\n  if (innerMapping.originalRange.containsPosition(posInOriginal)) {\n    return innerMapping.modifiedRange;\n  } else {\n    const l = lengthBetweenPositions(innerMapping.originalRange.getEndPosition(), posInOriginal);\n    return Range.fromPositions(l.addToPosition(innerMapping.modifiedRange.getEndPosition()));\n  }\n}\nfunction lengthBetweenPositions(position1, position2) {\n  if (position1.lineNumber === position2.lineNumber) {\n    return new TextLength(0, position2.column - position1.column);\n  } else {\n    return new TextLength(position2.lineNumber - position1.lineNumber, position2.column - 1);\n  }\n}\nexport function filterWithPrevious(arr, filter) {\n  let prev;\n  return arr.filter(cur => {\n    const result = filter(cur, prev);\n    prev = cur;\n    return result;\n  });\n}\nexport class RefCounted {\n  static create(value, debugOwner = undefined) {\n    return new BaseRefCounted(value, value, debugOwner);\n  }\n  static createWithDisposable(value, disposable, debugOwner = undefined) {\n    const store = new DisposableStore();\n    store.add(disposable);\n    store.add(value);\n    return new BaseRefCounted(value, store, debugOwner);\n  }\n}\nclass BaseRefCounted extends RefCounted {\n  constructor(object, _disposable, _debugOwner) {\n    super();\n    this.object = object;\n    this._disposable = _disposable;\n    this._debugOwner = _debugOwner;\n    this._refCount = 1;\n    this._isDisposed = false;\n    this._owners = [];\n    if (_debugOwner) {\n      this._addOwner(_debugOwner);\n    }\n  }\n  _addOwner(debugOwner) {\n    if (debugOwner) {\n      this._owners.push(debugOwner);\n    }\n  }\n  createNewRef(debugOwner) {\n    this._refCount++;\n    if (debugOwner) {\n      this._addOwner(debugOwner);\n    }\n    return new ClonedRefCounted(this, debugOwner);\n  }\n  dispose() {\n    if (this._isDisposed) {\n      return;\n    }\n    this._isDisposed = true;\n    this._decreaseRefCount(this._debugOwner);\n  }\n  _decreaseRefCount(debugOwner) {\n    this._refCount--;\n    if (this._refCount === 0) {\n      this._disposable.dispose();\n    }\n    if (debugOwner) {\n      const idx = this._owners.indexOf(debugOwner);\n      if (idx !== -1) {\n        this._owners.splice(idx, 1);\n      }\n    }\n  }\n}\nclass ClonedRefCounted extends RefCounted {\n  constructor(_base, _debugOwner) {\n    super();\n    this._base = _base;\n    this._debugOwner = _debugOwner;\n    this._isDisposed = false;\n  }\n  get object() {\n    return this._base.object;\n  }\n  createNewRef(debugOwner) {\n    return this._base.createNewRef(debugOwner);\n  }\n  dispose() {\n    if (this._isDisposed) {\n      return;\n    }\n    this._isDisposed = true;\n    this._base._decreaseRefCount(this._debugOwner);\n  }\n}","map":{"version":3,"names":["findLast","CancellationTokenSource","Disposable","DisposableStore","toDisposable","autorun","autorunHandleChanges","autorunOpts","autorunWithStore","observableValue","transaction","ElementSizeObserver","Position","Range","TextLength","joinCombine","arr1","arr2","keySelector","combine","length","result","i","j","val1","val2","key1","key2","push","applyObservableDecorations","editor","decorations","d","decorationsCollection","createDecorationsCollection","add","debugName","reader","read","set","dispose","clear","appendRemoveOnDispose","parent","child","appendChild","remove","prependRemoveOnDispose","prepend","ObservableElementSizeObserver","width","_width","height","_height","automaticLayout","_automaticLayout","constructor","element","dimension","elementSizeObserver","_register","getWidth","getHeight","onDidChange","e","tx","observe","setAutomaticLayout","startObserving","stopObserving","animatedObservable","targetWindow","base","store","targetVal","get","startVal","curVal","animationStartMs","durationMs","animationFrame","undefined","createEmptyChangeSummary","animate","handleChange","ctx","s","didChange","change","cancelAnimationFrame","Date","now","update","passedMs","Math","floor","easeOutExpo","requestAnimationFrame","t","b","c","pow","ViewZoneOverlayWidget","viewZone","htmlElement","ManagedOverlayWidget","applyStyle","actualHeight","top","actualTop","PlaceholderViewZone","afterLineNumber","_afterLineNumber","heightInPx","domNode","document","createElement","_actualTop","_actualHeight","showInHiddenAreas","onChange","onDomNodeTop","onComputedHeight","_editor","_domElement","_overlayWidgetId","_counter","_overlayWidget","getId","getDomNode","getPosition","addOverlayWidget","removeOverlayWidget","_ManagedOverlayWidget","style","key","val","Object","entries","replace","m","toLowerCase","applyViewZones","viewZones","setIsUpdating","zoneIds","lastViewZoneIds","curViewZones","viewZonIdsPerViewZone","Map","viewZoneIdPerOnChangeObservable","changeViewZones","a","id","removeZone","delete","z","addZone","setZoneId","context","changeSummary","changedObservable","vz","layoutZone","DisposableCancellationTokenSource","translatePosition","posInOriginal","mappings","mapping","original","startLineNumber","lineNumber","fromPositions","endLineNumberExclusive","newLineNumber","modified","column","innerChanges","innerMapping","originalRange","getStartPosition","isBeforeOrEqual","containsPosition","modifiedRange","l","lengthBetweenPositions","getEndPosition","addToPosition","position1","position2","filterWithPrevious","arr","filter","prev","cur","RefCounted","create","value","debugOwner","BaseRefCounted","createWithDisposable","disposable","object","_disposable","_debugOwner","_refCount","_isDisposed","_owners","_addOwner","createNewRef","ClonedRefCounted","_decreaseRefCount","idx","indexOf","splice","_base"],"sources":["P:/IDEA/JudgeX/JudgeX_front/node_modules/monaco-editor/esm/vs/editor/browser/widget/diffEditor/utils.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { findLast } from '../../../../base/common/arraysFind.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { autorun, autorunHandleChanges, autorunOpts, autorunWithStore, observableValue, transaction } from '../../../../base/common/observable.js';\nimport { ElementSizeObserver } from '../../config/elementSizeObserver.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { TextLength } from '../../../common/core/textLength.js';\nexport function joinCombine(arr1, arr2, keySelector, combine) {\n    if (arr1.length === 0) {\n        return arr2;\n    }\n    if (arr2.length === 0) {\n        return arr1;\n    }\n    const result = [];\n    let i = 0;\n    let j = 0;\n    while (i < arr1.length && j < arr2.length) {\n        const val1 = arr1[i];\n        const val2 = arr2[j];\n        const key1 = keySelector(val1);\n        const key2 = keySelector(val2);\n        if (key1 < key2) {\n            result.push(val1);\n            i++;\n        }\n        else if (key1 > key2) {\n            result.push(val2);\n            j++;\n        }\n        else {\n            result.push(combine(val1, val2));\n            i++;\n            j++;\n        }\n    }\n    while (i < arr1.length) {\n        result.push(arr1[i]);\n        i++;\n    }\n    while (j < arr2.length) {\n        result.push(arr2[j]);\n        j++;\n    }\n    return result;\n}\n// TODO make utility\nexport function applyObservableDecorations(editor, decorations) {\n    const d = new DisposableStore();\n    const decorationsCollection = editor.createDecorationsCollection();\n    d.add(autorunOpts({ debugName: () => `Apply decorations from ${decorations.debugName}` }, reader => {\n        const d = decorations.read(reader);\n        decorationsCollection.set(d);\n    }));\n    d.add({\n        dispose: () => {\n            decorationsCollection.clear();\n        }\n    });\n    return d;\n}\nexport function appendRemoveOnDispose(parent, child) {\n    parent.appendChild(child);\n    return toDisposable(() => {\n        child.remove();\n    });\n}\nexport function prependRemoveOnDispose(parent, child) {\n    parent.prepend(child);\n    return toDisposable(() => {\n        child.remove();\n    });\n}\nexport class ObservableElementSizeObserver extends Disposable {\n    get width() { return this._width; }\n    get height() { return this._height; }\n    get automaticLayout() { return this._automaticLayout; }\n    constructor(element, dimension) {\n        super();\n        this._automaticLayout = false;\n        this.elementSizeObserver = this._register(new ElementSizeObserver(element, dimension));\n        this._width = observableValue(this, this.elementSizeObserver.getWidth());\n        this._height = observableValue(this, this.elementSizeObserver.getHeight());\n        this._register(this.elementSizeObserver.onDidChange(e => transaction(tx => {\n            /** @description Set width/height from elementSizeObserver */\n            this._width.set(this.elementSizeObserver.getWidth(), tx);\n            this._height.set(this.elementSizeObserver.getHeight(), tx);\n        })));\n    }\n    observe(dimension) {\n        this.elementSizeObserver.observe(dimension);\n    }\n    setAutomaticLayout(automaticLayout) {\n        this._automaticLayout = automaticLayout;\n        if (automaticLayout) {\n            this.elementSizeObserver.startObserving();\n        }\n        else {\n            this.elementSizeObserver.stopObserving();\n        }\n    }\n}\nexport function animatedObservable(targetWindow, base, store) {\n    let targetVal = base.get();\n    let startVal = targetVal;\n    let curVal = targetVal;\n    const result = observableValue('animatedValue', targetVal);\n    let animationStartMs = -1;\n    const durationMs = 300;\n    let animationFrame = undefined;\n    store.add(autorunHandleChanges({\n        createEmptyChangeSummary: () => ({ animate: false }),\n        handleChange: (ctx, s) => {\n            if (ctx.didChange(base)) {\n                s.animate = s.animate || ctx.change;\n            }\n            return true;\n        }\n    }, (reader, s) => {\n        /** @description update value */\n        if (animationFrame !== undefined) {\n            targetWindow.cancelAnimationFrame(animationFrame);\n            animationFrame = undefined;\n        }\n        startVal = curVal;\n        targetVal = base.read(reader);\n        animationStartMs = Date.now() - (s.animate ? 0 : durationMs);\n        update();\n    }));\n    function update() {\n        const passedMs = Date.now() - animationStartMs;\n        curVal = Math.floor(easeOutExpo(passedMs, startVal, targetVal - startVal, durationMs));\n        if (passedMs < durationMs) {\n            animationFrame = targetWindow.requestAnimationFrame(update);\n        }\n        else {\n            curVal = targetVal;\n        }\n        result.set(curVal, undefined);\n    }\n    return result;\n}\nfunction easeOutExpo(t, b, c, d) {\n    return t === d ? b + c : c * (-Math.pow(2, -10 * t / d) + 1) + b;\n}\nexport class ViewZoneOverlayWidget extends Disposable {\n    constructor(editor, viewZone, htmlElement) {\n        super();\n        this._register(new ManagedOverlayWidget(editor, htmlElement));\n        this._register(applyStyle(htmlElement, {\n            height: viewZone.actualHeight,\n            top: viewZone.actualTop,\n        }));\n    }\n}\nexport class PlaceholderViewZone {\n    get afterLineNumber() { return this._afterLineNumber.get(); }\n    constructor(_afterLineNumber, heightInPx) {\n        this._afterLineNumber = _afterLineNumber;\n        this.heightInPx = heightInPx;\n        this.domNode = document.createElement('div');\n        this._actualTop = observableValue(this, undefined);\n        this._actualHeight = observableValue(this, undefined);\n        this.actualTop = this._actualTop;\n        this.actualHeight = this._actualHeight;\n        this.showInHiddenAreas = true;\n        this.onChange = this._afterLineNumber;\n        this.onDomNodeTop = (top) => {\n            this._actualTop.set(top, undefined);\n        };\n        this.onComputedHeight = (height) => {\n            this._actualHeight.set(height, undefined);\n        };\n    }\n}\nexport class ManagedOverlayWidget {\n    static { this._counter = 0; }\n    constructor(_editor, _domElement) {\n        this._editor = _editor;\n        this._domElement = _domElement;\n        this._overlayWidgetId = `managedOverlayWidget-${ManagedOverlayWidget._counter++}`;\n        this._overlayWidget = {\n            getId: () => this._overlayWidgetId,\n            getDomNode: () => this._domElement,\n            getPosition: () => null\n        };\n        this._editor.addOverlayWidget(this._overlayWidget);\n    }\n    dispose() {\n        this._editor.removeOverlayWidget(this._overlayWidget);\n    }\n}\nexport function applyStyle(domNode, style) {\n    return autorun(reader => {\n        /** @description applyStyle */\n        for (let [key, val] of Object.entries(style)) {\n            if (val && typeof val === 'object' && 'read' in val) {\n                val = val.read(reader);\n            }\n            if (typeof val === 'number') {\n                val = `${val}px`;\n            }\n            key = key.replace(/[A-Z]/g, m => '-' + m.toLowerCase());\n            domNode.style[key] = val;\n        }\n    });\n}\nexport function applyViewZones(editor, viewZones, setIsUpdating, zoneIds) {\n    const store = new DisposableStore();\n    const lastViewZoneIds = [];\n    store.add(autorunWithStore((reader, store) => {\n        /** @description applyViewZones */\n        const curViewZones = viewZones.read(reader);\n        const viewZonIdsPerViewZone = new Map();\n        const viewZoneIdPerOnChangeObservable = new Map();\n        // Add/remove view zones\n        if (setIsUpdating) {\n            setIsUpdating(true);\n        }\n        editor.changeViewZones(a => {\n            for (const id of lastViewZoneIds) {\n                a.removeZone(id);\n                zoneIds?.delete(id);\n            }\n            lastViewZoneIds.length = 0;\n            for (const z of curViewZones) {\n                const id = a.addZone(z);\n                if (z.setZoneId) {\n                    z.setZoneId(id);\n                }\n                lastViewZoneIds.push(id);\n                zoneIds?.add(id);\n                viewZonIdsPerViewZone.set(z, id);\n            }\n        });\n        if (setIsUpdating) {\n            setIsUpdating(false);\n        }\n        // Layout zone on change\n        store.add(autorunHandleChanges({\n            createEmptyChangeSummary() {\n                return { zoneIds: [] };\n            },\n            handleChange(context, changeSummary) {\n                const id = viewZoneIdPerOnChangeObservable.get(context.changedObservable);\n                if (id !== undefined) {\n                    changeSummary.zoneIds.push(id);\n                }\n                return true;\n            },\n        }, (reader, changeSummary) => {\n            /** @description layoutZone on change */\n            for (const vz of curViewZones) {\n                if (vz.onChange) {\n                    viewZoneIdPerOnChangeObservable.set(vz.onChange, viewZonIdsPerViewZone.get(vz));\n                    vz.onChange.read(reader);\n                }\n            }\n            if (setIsUpdating) {\n                setIsUpdating(true);\n            }\n            editor.changeViewZones(a => { for (const id of changeSummary.zoneIds) {\n                a.layoutZone(id);\n            } });\n            if (setIsUpdating) {\n                setIsUpdating(false);\n            }\n        }));\n    }));\n    store.add({\n        dispose() {\n            if (setIsUpdating) {\n                setIsUpdating(true);\n            }\n            editor.changeViewZones(a => { for (const id of lastViewZoneIds) {\n                a.removeZone(id);\n            } });\n            zoneIds?.clear();\n            if (setIsUpdating) {\n                setIsUpdating(false);\n            }\n        }\n    });\n    return store;\n}\nexport class DisposableCancellationTokenSource extends CancellationTokenSource {\n    dispose() {\n        super.dispose(true);\n    }\n}\nexport function translatePosition(posInOriginal, mappings) {\n    const mapping = findLast(mappings, m => m.original.startLineNumber <= posInOriginal.lineNumber);\n    if (!mapping) {\n        // No changes before the position\n        return Range.fromPositions(posInOriginal);\n    }\n    if (mapping.original.endLineNumberExclusive <= posInOriginal.lineNumber) {\n        const newLineNumber = posInOriginal.lineNumber - mapping.original.endLineNumberExclusive + mapping.modified.endLineNumberExclusive;\n        return Range.fromPositions(new Position(newLineNumber, posInOriginal.column));\n    }\n    if (!mapping.innerChanges) {\n        // Only for legacy algorithm\n        return Range.fromPositions(new Position(mapping.modified.startLineNumber, 1));\n    }\n    const innerMapping = findLast(mapping.innerChanges, m => m.originalRange.getStartPosition().isBeforeOrEqual(posInOriginal));\n    if (!innerMapping) {\n        const newLineNumber = posInOriginal.lineNumber - mapping.original.startLineNumber + mapping.modified.startLineNumber;\n        return Range.fromPositions(new Position(newLineNumber, posInOriginal.column));\n    }\n    if (innerMapping.originalRange.containsPosition(posInOriginal)) {\n        return innerMapping.modifiedRange;\n    }\n    else {\n        const l = lengthBetweenPositions(innerMapping.originalRange.getEndPosition(), posInOriginal);\n        return Range.fromPositions(l.addToPosition(innerMapping.modifiedRange.getEndPosition()));\n    }\n}\nfunction lengthBetweenPositions(position1, position2) {\n    if (position1.lineNumber === position2.lineNumber) {\n        return new TextLength(0, position2.column - position1.column);\n    }\n    else {\n        return new TextLength(position2.lineNumber - position1.lineNumber, position2.column - 1);\n    }\n}\nexport function filterWithPrevious(arr, filter) {\n    let prev;\n    return arr.filter(cur => {\n        const result = filter(cur, prev);\n        prev = cur;\n        return result;\n    });\n}\nexport class RefCounted {\n    static create(value, debugOwner = undefined) {\n        return new BaseRefCounted(value, value, debugOwner);\n    }\n    static createWithDisposable(value, disposable, debugOwner = undefined) {\n        const store = new DisposableStore();\n        store.add(disposable);\n        store.add(value);\n        return new BaseRefCounted(value, store, debugOwner);\n    }\n}\nclass BaseRefCounted extends RefCounted {\n    constructor(object, _disposable, _debugOwner) {\n        super();\n        this.object = object;\n        this._disposable = _disposable;\n        this._debugOwner = _debugOwner;\n        this._refCount = 1;\n        this._isDisposed = false;\n        this._owners = [];\n        if (_debugOwner) {\n            this._addOwner(_debugOwner);\n        }\n    }\n    _addOwner(debugOwner) {\n        if (debugOwner) {\n            this._owners.push(debugOwner);\n        }\n    }\n    createNewRef(debugOwner) {\n        this._refCount++;\n        if (debugOwner) {\n            this._addOwner(debugOwner);\n        }\n        return new ClonedRefCounted(this, debugOwner);\n    }\n    dispose() {\n        if (this._isDisposed) {\n            return;\n        }\n        this._isDisposed = true;\n        this._decreaseRefCount(this._debugOwner);\n    }\n    _decreaseRefCount(debugOwner) {\n        this._refCount--;\n        if (this._refCount === 0) {\n            this._disposable.dispose();\n        }\n        if (debugOwner) {\n            const idx = this._owners.indexOf(debugOwner);\n            if (idx !== -1) {\n                this._owners.splice(idx, 1);\n            }\n        }\n    }\n}\nclass ClonedRefCounted extends RefCounted {\n    constructor(_base, _debugOwner) {\n        super();\n        this._base = _base;\n        this._debugOwner = _debugOwner;\n        this._isDisposed = false;\n    }\n    get object() { return this._base.object; }\n    createNewRef(debugOwner) {\n        return this._base.createNewRef(debugOwner);\n    }\n    dispose() {\n        if (this._isDisposed) {\n            return;\n        }\n        this._isDisposed = true;\n        this._base._decreaseRefCount(this._debugOwner);\n    }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}